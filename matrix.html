<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
<style>
main{margin:auto}table{margin:auto;border-collapse:collapse}th,td{width:80px;height:80px;padding:.5rem;text-align:center;border:1px solid #ccc;cursor:pointer}th.select{background:#def}.hl,.highlight{background-color:#fcf}.bf,.highlight-buffer{background-color:#cff}.hl,.bf{display:inline-block;width:1em;height:1em;border-radius:50%}.action-panel{margin-top:1.5rem;padding:1rem 1.5rem;background:#f9f9ff;border:1px solid #ccd;border-radius:8px;display:flex;align-items:center;gap:.4rem;flex-wrap:wrap;font-size:1.05rem}.action-panel select{padding:.3rem .5rem;border:1px solid #bbb;border-radius:6px;font-size:1rem;background:#fff}.action-panel button{padding:.4rem .7rem;border:none;border-radius:4px;font-size:1rem;cursor:pointer}.neg-inactive{background:none;color:#ccc;border:1px solid #ccc}.neg-active{background:none;color:#000;border:1px solid #000}.fraction-preview{margin-left:.4rem;font-size:.95rem;color:#556}
</style>
</head>
<body>
<main class="container" x-data="matrixGame()">
  <table>
    <tbody>
      <template x-for="i in n" :key="i">
        <tr>
          <template x-for="j in n" :key="j">
            <td :class="{
              'highlight': selected === (mode === 'row' ? j : i),
              'highlight-buffer': buffer === (mode === 'row' ? j : i)}"
             x-text="A[i-1][j-1].toFixed(1)" @click="selectCol(i)"></td>
          </template>
        </tr>
      </template>
    </tbody>
  </table>
<div class="action-panel"
     x-data="{
       num: 1,
       den: 1,
       numNeg: false,
       numbers: [1,2,3,4,5,6,7,8,9],
       get factor(){
         let n = this.numNeg ? -this.num : this.num;
         return n / this.den;
       },
     }">

  <span class="hl"></span>에 
  <span class="bf"></span>의

  <!-- 분자 -->
  <button
          @click="numNeg = !numNeg"
          :class="{'neg-active': numNeg, 'neg-inactive': !numNeg}">−</button>
  <select x-model.number="num">
    <template x-for="n in numbers" :key="'n'+n">
      <option :value="n" x-text="n"></option>
    </template>
  </select>
/
  <!-- 분모 (양수만) -->
  <select x-model.number="den">
    <template x-for="d in numbers" :key="'d'+d">
      <option :value="d" x-text="d"></option>
    </template>
  </select>

  배 만큼 더하기
  <button @click="addi(factor)">실행!</button>
</div>
<!-- 곱하기: 선택된 행/열에 factor배 곱하기 -->
<div class="action-panel"
     x-data="{
       mNum: 1,
       mDen: 1,
       mNeg: false,
       numbers: [1,2,3,4,5,6,7,8,9],
       get factor(){
         let n = this.mNeg ? -this.mNum : this.mNum;
         return n / this.mDen;
       },
     }">
  <span class="hl"></span>을

  <!-- 분자(부호 토글) -->
  <button
    @click="mNeg = !mNeg"
    :class="{'neg-active': mNeg, 'neg-inactive': !mNeg}">−</button>

  <select x-model.number="mNum">
    <template x-for="n in numbers" :key="'m-n'+n">
      <option :value="n" x-text="n"></option>
    </template>
  </select>

  <span>/</span>

  <!-- 분모 (양수만) -->
  <select x-model.number="mDen">
    <template x-for="d in numbers" :key="'m-d'+d">
      <option :value="d" x-text="d"></option>
    </template>
  </select>

  배 만큼 곱하기
  <button @click="mult(factor)">실행!</button>
</div>

<!-- 스왑: 선택된 두 대상 서로 교환 -->
<div class="action-panel">
  <span class="hl"></span>과 <span class="bf"></span>를 서로 바꾸기
  <button
    @click="swap()">
    실행!
  </button>
</main>

<script>
function matrixGame(){
  return {
    n: 3,
    A: [[2,1,0],[0,1,1],[1,0,1]],
    selected: null,
    buffer: null,
    mode: 'col', // or row
    selectCol(i){
      this.buffer = this.selected;
      this.selected = i;
      if (this.buffer === this.selected) this.buffer = null;
    },addi(factor) {
      if (this.selected === null || this.buffer === null) return;

      const sel = this.selected - 1;
      const buf = this.buffer - 1;

      if (this.mode === 'col') {
        // 행 연산: sel행 ← sel행 + buf행 × factor
        for (let i = 0; i < this.A[0].length; i++) {
          this.A[sel][i] += this.A[buf][i] * factor;
        }
      } else if (this.mode === 'row') {
        // 열 연산: sel열 ← sel열 + buf열 × factor
        for (let i = 0; i < this.A.length; i++) {
          this.A[i][sel] += this.A[i][buf] * factor;
        }
      }
    },

    swap() {
      if (this.selected === null || this.buffer === null) return;
      const sel = this.selected - 1;
      const buf = this.buffer - 1;

      if (this.mode === 'col') {
        // 행 스왑
        const temp = this.A[sel];
        this.A[sel] = this.A[buf];
        this.A[buf] = temp;
      } else if (this.mode === 'row') {
        // 열 스왑
        for (let i = 0; i < this.A.length; i++) {
          const temp = this.A[i][sel];
          this.A[i][sel] = this.A[i][buf];
          this.A[i][buf] = temp;
        }
      }
    },
    mult(factor) {
      if (this.selected === null) return;

      const sel = this.selected - 1;

      if (this.mode === 'col') {
        // 행 전체를 factor배
        for (let i = 0; i < this.A[0].length; i++) {
          this.A[sel][i] *= factor;
        }
      } else if (this.mode === 'row') {
        // 열 전체를 factor배
        for (let i = 0; i < this.A.length; i++) {
          this.A[i][sel] *= factor;
        }
      }
    }
  }
}
</script>
</body>
</html>
